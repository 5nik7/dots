#!/usr/bin/env bash

main() {
  [ "$#" -gt 0 ] || {
    local ingit=$(command git rev-parse --is-inside-work-tree 2>/dev/null)

    if [[ "$ingit" = true ]]; then
      GIT_REMOTE=$(command git remote get-url origin 2>/dev/null)
      if [[ -z "$GIT_REMOTE" ]]; then
        GIT_REMOTE=$(command git ls-remote --get-url 2>/dev/null)
      fi
      GIT_REMOTE_URL=$(echo $GIT_REMOTE | sed -E "s/^https?:\\/\\/(.+@)?//; s/\\.git$//; s/\\.git$//; s/.+@(.+):([[:digit:]]+)\\/(.+)$/\\1\\/\\3/; s/.+@(.+):(.+)$/\\1\\/\\2/; s/\\/$//")
      openurl "$GIT_REMOTE_URL"
      exit 0
    fi

    if [[ ! -z "$WWW" ]]; then
      openurl "$WWW"
      exit 0
    fi

    openurl "https://google.com"
  }
  if [ "$#" -gt 0 ]; then
    openurl "$1"
    exit 0
  fi
}

main "$@"
